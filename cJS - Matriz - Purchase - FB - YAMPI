function() {           

  var products = {{DLV - order.items}}; // matriz de produtos

  var tam = products.length; // comprimento da matriz de produtos

  var indice = 0;

  var product = products[indice].product; // acessa o objeto `product` dentro de cada item

  var viarray = [{

      "id": product.id,

      "title": products[indice].name,

      "brand": products[indice].brand,                

      "quantity": products[indice].quantity,

      "item_price": product.price // Corrigido para puxar o preço de 'product'

    }];  

  var tam = tam - 1;  

  while (tam != 0) {

    indice = indice + 1;

    product = products[indice].product; // acessa o objeto `product` dentro de cada item

    viarray.push({

      "id": product.id,

      "title": products[indice].name,

      "brand": products[indice].brand,                 

      "quantity": products[indice].quantity,

      "item_price": product.price // Corrigido para puxar o preço de 'product'

    });

    tam = tam - 1;

  }

  return viarray;

}
